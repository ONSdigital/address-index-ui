{% extends './aims_ui_pages/0-base_page_settings.html' %}

{% from "components/card/_macro.njk" import onsCard %}
{% from 'components/panel/_macro.njk' import onsPanel %}
{% from 'components/list/_macro.njk' import onsList %}
{% from 'custom_search/_macro.njk' import customSearch %}
{% from 'custom_address_info/_macro.njk' import customAddressInfo %}
{% from "components/table/_macro.njk" import onsTable %}
{% from "components/section-navigation/_macro.njk" import onsSectionNavigation %}

{# In order to specify wider than usual components, page must be in "pageContent" #}
{% block pageContent %}
{% block main %}

<link rel="stylesheet" href="static/css/a_single_matches/radiussearch.css">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

<form method="POST" id="searchform">

{# Add a grid (this is normally done automatically but this overrides the current system to make the box wider) #}
<div class="ons-grid">

{# 1Column boarder#}
  <div id="space_col_1" class="ons-grid__col ons-col-1@m "></div>

{# Content is the searchboxes, taing up 4 col#}
  <div id="content_col_2" class="ons-grid__col ons-col-4@m ">

{{ customSearch ({ "Fields": searchable_fields,
		   "endpoints": endpoints,
		   "remove_search_button":False,
       "results_page": results_page, }) }}
<br>
</div>


<div id="mapContainer" style="width: 50%;">

  <div id="map" aria-label="Interactive map"></div>

</div>


</form>

<div id="space_col_3" class="ons-grid__col ons-col-1@m "></div>


{# 5 Col results page #}
  <div id="content_col_4" class="ons-grid__col ons-col-5@m ">

	{# Title and description #}
	{% for endpoint in endpoints %}
	{% if endpoint.selected %}
	<br>
		{{ onsCard({
		    "id": 	endpoint.id,
		    "textId": 	'text',
		    "titleSize":endpoint.title_size,
		    "titleClasses": 'header__title',
		    "title": 	endpoint.title,
		    "url": 	endpoint.url,
		    "text": 	endpoint.description_text,
		}) }}
	<br>
	{% endif %}
	{% endfor %}


	{% if results_page %}
	  {{ onsPanel({
	  "body": "",
	  "classes": "ons-u-hidden",
	  "id": "requestOverviewStatsPanel",
	  "attributes": {'valuesOfrequestAttributes': responseAttributes , 'tokenisedOutput': tokenisedOutput},
	   }) }}
	  <br>
	  <br>
	  <h2>We matched {{matched_address_number}}  addresses:</h2>
	{% endif %}

	{{ customAddressInfo ({
		'matched_addresses': matched_addresses,
		}) }}

</div>

{# End of grid #}
</div>

<script type=module src="static/js/e_all_pages/all_pages_first_js.mjs"></script>
<script type=module src="static/js/e_all_pages/apply_custom_settings.mjs"></script>

<!-- Load Leaflet JS before page specific scripts that use the interactive map that relies on leaflet -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script type=module src="static/js/a_single_matches/radiussearch.mjs"></script>
<!-- We do not need custom column widths here as this page's layout is handled by CSS -->

<script type=module src="static/js/e_all_pages/all_pages_last.mjs"></script>

{% endblock %}
{% endblock %}
