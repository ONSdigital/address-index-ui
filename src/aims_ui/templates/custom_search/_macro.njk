{% macro customSearch(params) %}

{% from 'components/input/_macro.njk' import onsInput %}
{% from 'components/select/_macro.njk' import onsSelect %}
{% from "components/checkboxes/_checkbox-macro.njk" import onsCheckbox %}
{% from "components/button/_macro.njk" import onsButton %}

{% set col = namespace(value=-1) %}
{% set row = namespace(value=0) %}
{% set max_col = 1 %}


{# If it's a results page then have the searchboxes arranged at the top #}
{% if params.results_page %}
	<table>
{% endif %}

{% for field in params.Fields %}

	{% if params.results_page %}
		{# Update  the col/row  values for the next  searchitem  #}
		{% if col.value == max_col %}
			{% set row.value = row.value + 1 %}
			{% set col.value = 0 %}
		{% else %}
			{% set col.value = col.value + 1 %}
		{% endif %}

		{# If a  new row  required, start "tablerow" #}
		{% if col.value == 0 %}
			</tr>
			<tr>
			<td>
		{% else %}
			<td>
		{% endif %}
	{% endif %}



	<br>
	{# Code to generate actual searchui here #}
	{% if field.search_type == "input_box" %}
	{{onsInput({
		"id"   : field.database_name,
		"name" : field.database_name,
		"classes": field.classes,
		"label": { "text": field.display_title,
			   "description": field.description },
		"value": field.previous_value,   })}}
	{% elif field.search_type == "dropdown" %}
	{{onsSelect({
		"id"   : field.database_name,
		"name" : field.database_name,
		"label": { "text": field.display_title, 
			   "description": field.description },
		"options": field.dropdown_options })}}
	{% elif field.search_type == "checkbox" %}
	{{onsCheckbox({
		"id": field.database_name,
		"name": field.database_name,
		"label": { "text": field.display_title, 
			   "description": field.description },
		"value": True,
		"checked": field.checkbox_value,
	})}}
	<br>


	{% if params.results_page %}
	      {# End table row/element #}
		{% if col.value == 0 %}
			<td>
			{{onsInput({
			"type": "hidden",
			"classes": "u-d-no",
			"id": "adlocation",
			"name": "adlocation",
			"value": adlocation,
			"label": {
			"text": "Enter some text",
			"classes": "u-d-no"}})}}
			</td>
		{% else %}
			</td>
		{% endif %}
		</table>
	{% endif %}

{% endif %}
{% endfor %}

<br>
{# Add a search button on the end of the UI #}
{{  onsButton({ 
	"text": "Search", }) }}
	

{% endmacro %}
